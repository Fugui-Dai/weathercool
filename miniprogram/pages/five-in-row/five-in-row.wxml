<view class="container">
    <!-- 分数显示 -->
    <view class="score-info">
        <text>分数: {{score}} 最高分: {{highScore}}</text>
        <text wx:if="{{isPaused}}">暂停</text>
    </view>

    <!-- 游戏区域 -->
    <view class="game-board">
        <view class="board-grid">
            <block wx:for="{{board}}" wx:key="index">
                <view class="board-cell {{item.type}} {{item.selected ? 'selected' : ''}}" data-index="{{index}}" bindtap="onCellTap">
                    <view class="ball {{item.type}}" wx:if="{{item.type !== 'empty'}}"></view>
                </view>
            </block>
        </view>
    </view>

    <!-- 道具说明 -->
    <view class="tools-legend">
        <view class="legend-item">
            <image src="/assets/icons/bomb.svg" mode="aspectFit" />
            <text class="tool-name">炸弹</text>
            <text class="tool-desc">消除3x3范围内的球</text>
        </view>
        <view class="legend-item">
            <image src="/assets/icons/color-changer.svg" mode="aspectFit" />
            <text class="tool-name">变色</text>
            <text class="tool-desc">生成一个相邻颜色的球</text>
        </view>
        <view class="legend-item">
            <image src="/assets/icons/undo.svg" mode="aspectFit" />
            <text class="tool-name">撤销</text>
            <text class="tool-desc">撤回上一步移动</text>
        </view>
        <view class="legend-item">
            <image src="/assets/icons/refresh.svg" mode="aspectFit" />
            <text class="tool-name">刷新</text>
            <text class="tool-desc">重新排列所有球</text>
        </view>
    </view>

    <!-- 工具栏 -->
    <view class="toolbar">
        <view class="tool-item {{bombCount <= 0 ? 'disabled' : ''}} {{selectedTool === 'bomb' ? 'selected' : ''}}" data-tool="bomb" bindtap="selectTool">
            <image class="tool-icon" src="/assets/icons/bomb.svg" mode="aspectFit" />
            <view class="tool-info">
                <text class="tool-count">{{bombCount}}</text>
            </view>
        </view>
        <view class="tool-item {{colorChangerCount <= 0 ? 'disabled' : ''}} {{selectedTool === 'colorChanger' ? 'selected' : ''}}" data-tool="colorChanger" bindtap="selectTool">
            <image class="tool-icon" src="/assets/icons/color-changer.svg" mode="aspectFit" />
            <view class="tool-info">
                <text class="tool-count">{{colorChangerCount}}</text>
            </view>
        </view>
        <view class="tool-item {{undoCount <= 0 ? 'disabled' : ''}}" bindtap="undo">
            <image class="tool-icon" src="/assets/icons/undo.svg" mode="aspectFit" />
            <view class="tool-info">
                <text class="tool-count">{{undoCount}}</text>
            </view>
        </view>
        <view class="tool-item {{refreshCount <= 0 ? 'disabled' : ''}}" bindtap="refresh">
            <image class="tool-icon" src="/assets/icons/refresh.svg" mode="aspectFit" />
            <view class="tool-info">
                <text class="tool-count">{{refreshCount}}</text>
            </view>
        </view>
    </view>

    <!-- 游戏结束弹窗 -->
    <view class="modal" wx:if="{{isGameOver}}">
        <view class="modal-content">
            <text>游戏结束</text>
            <text>得分: {{score}}</text>
            <text>最高分: {{highScore}}</text>
            <button bindtap="restartGame">重新开始</button>
            <button bindtap="goBack">返回主页</button>
        </view>
    </view>
</view>